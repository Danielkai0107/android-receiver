âœ… API é…ç½®å·²æ›´æ–°ç‚ºå…¨å±€ç™½åå–®æ¨¡å¼ï¼

ä¿®æ”¹å…§å®¹ï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ ç™½åå–® API URL
   èˆŠ: https://us-central1-safe-net-tw.cloudfunctions.net/getDeviceWhitelist
   æ–°: https://getdevicewhitelist-kmzfyt3t5a-uc.a.run.app/ âœ…

2ï¸âƒ£ API åƒæ•¸
   èˆŠ: @GET("getDeviceWhitelist") + gateway_id åƒæ•¸
   æ–°: @GET("/") + ç„¡åƒæ•¸ âœ…

3ï¸âƒ£ èª¿ç”¨æ–¹å¼
   èˆŠ: whitelistApi.getDeviceWhitelist(gatewayId)
   æ–°: whitelistApi.getDeviceWhitelist() âœ…

å·¥ä½œæµç¨‹ï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ¥æ”¶å™¨ App
  â†“
èª¿ç”¨ GET https://getdevicewhitelist-kmzfyt3t5a-uc.a.run.app
  â†“
Cloud Function è¿”å›æ‰€æœ‰ isActive=true çš„è¨­å‚™
  â†“
{
  "success": true,
  "devices": [æ‰€æœ‰æ´»èºè¨­å‚™],
  "count": 10,
  "timestamp": xxx
}
  â†“
App ä¿å­˜åˆ°æœ¬åœ°ç™½åå–®
  â†“
æƒææ™‚æ¯”å° UUID + Major + Minor
  â†“
åŒ¹é…çš„ Beacon ä¸Šå‚³åˆ° receiveBeaconData
  â†“
POST https://receivebeacondata-kmzfyt3t5a-uc.a.run.app
{
  "gateway_id": "ANDROID-xxx",
  "lat": 25.033,
  "lng": 121.565,
  "timestamp": xxx,
  "beacons": [...]
}
  â†“
Cloud Function è™•ç†ï¼š
  - ç”¨ UUID+Major+Minor æ‰¾è¨­å‚™
  - æ‰¾åˆ°å°æ‡‰çš„é•·è€…
  - æ›´æ–°ä½ç½®ï¼ˆ5åˆ†é˜å†·å»ï¼‰
  - ç™¼é€ LINE é€šçŸ¥
  â†“
å®Œæˆï¼

å„ªé»ï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… æ‰€æœ‰æ¥æ”¶å™¨ç²å–ç›¸åŒç™½åå–®
âœ… ç„¡éœ€é å…ˆè¨»å†Šæ¯å€‹æ¥æ”¶å™¨
âœ… å³è£å³ç”¨
âœ… é›†ä¸­ç®¡ç†ï¼ˆåªéœ€åœ¨ devices é›†åˆç®¡ç†ï¼‰
âœ… ç°¡åŒ–éƒ¨ç½²æµç¨‹

èˆ‡ Cloud Function çš„å®Œç¾é…åˆï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… getDeviceWhitelist: è¿”å›æ‰€æœ‰è¨­å‚™
âœ… receiveBeaconData: ç”¨ UUID+Major+Minor è­˜åˆ¥
âœ… ä¸ä¾è³´ gateway_id éæ¿¾
âœ… æ¥æ”¶å™¨å¯ä»¥è‡ªç”±å¢æ¸›

æ¸¬è©¦æ­¥é©Ÿï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. åœ¨ Android Studio ä¸­ Run
2. App æ‰“é–‹è‡ªå‹•åŒæ­¥ç™½åå–®
3. æ‡‰è©²æœƒæˆåŠŸç²å–è¨­å‚™åˆ—è¡¨
4. ç™½åå–®è¨­å‚™æ•¸æœƒé¡¯ç¤ºå¯¦éš›æ•¸é‡
5. é–‹å§‹æƒææ¸¬è©¦ï¼

ğŸ‰ å®Œç¾å°æ¥æ‚¨çš„ Cloud Functionsï¼
